<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Praga</title>
    <link rel="icon" href="biohazard-sign.png" type="image/png">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;600;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --red: #ff1744; --blue: #00e5ff; --gold: #ffd700; --green: #00e676; --dark: #080808;
            --glass: rgba(10, 10, 10, 0.95); --border: rgba(255, 255, 255, 0.1);
        }
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Rajdhani', sans-serif; background: var(--dark); color: white; overflow: hidden; height: 100vh; }

        /* TELAS PRINCIPAIS */
        .full-screen { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 5000; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: 0.8s ease; }
        #startMenu { background: radial-gradient(circle, #ff1744 0%, #600000 50%, #000 100%); }
        #gameSetup { background: #000; display: none; }
        #mainGame { display: none; z-index: 1; }

        /* COMPONENTES DE UI */
        .glass { background: var(--glass); backdrop-filter: blur(15px); border: 1px solid var(--border); border-radius: 10px; }
        .overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.9); z-index: 6000; display: none; align-items: center; justify-content: center; }
        
        /* MENU & BOT√ïES */
        .bio-logo { font-family: 'Orbitron', sans-serif; font-size: 4rem; text-align: center; margin-bottom: 40px; }
        .btn-main { background: white; color: #800000; border: none; padding: 15px 40px; font-size: 1.5rem; font-weight: 800; border-radius: 8px; cursor: pointer; transition: 0.3s; width: 280px; margin: 10px; text-transform: uppercase; }
        .btn-main:hover { background: var(--red); color: white; transform: translateY(-3px); box-shadow: 0 5px 15px rgba(255, 23, 68, 0.4); }
        .btn-close { position: absolute; top: 20px; right: 20px; background: none; border: none; color: white; font-size: 2rem; cursor: pointer; }

        /* HUD JOGO */
        #map { width: 100%; height: 100vh; z-index: 0; }
        .top-hud { position: fixed; top: 10px; width: 96%; left: 2%; height: 45px; display: flex; align-items: center; padding: 0 20px; z-index: 1000; }
        .bottom-hud { position: fixed; bottom: 10px; width: 96%; left: 2%; height: 110px; display: flex; align-items: center; justify-content: space-between; padding: 0 20px; z-index: 1000; }

        /* BARRAS DE STATUS */
        .bars-box { flex: 1; margin: 0 30px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .bar-wrap { display: flex; flex-direction: column; }
        .bar-label { font-size: 0.65rem; color: #aaa; text-transform: uppercase; margin-bottom: 2px; }
        .bar-bg { width: 100%; height: 8px; background: #111; border-radius: 4px; overflow: hidden; border: 1px solid rgba(255,255,255,0.05); }
        .bar-fill { height: 100%; width: 0%; transition: 1s linear; }

        /* SETUP SCREENS */
        .setup-card { width: 500px; padding: 40px; text-align: center; }
        .type-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0; }
        .type-item { padding: 15px; border: 1px solid #333; border-radius: 8px; cursor: pointer; transition: 0.3s; }
        .type-item:hover, .type-item.selected { border-color: var(--red); background: rgba(255,23,68,0.1); }
        input[type="text"] { width: 100%; padding: 12px; background: #111; border: 1px solid #333; color: white; border-radius: 5px; margin: 20px 0; text-align: center; font-family: 'Rajdhani'; font-size: 1.2rem; }

        /* POPUP PA√çS */
        .country-popup { position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 350px; padding: 25px; z-index: 7000; display: none; }
    </style>
</head>
<body>

    <div id="startMenu" class="full-screen">
        <div class="bio-logo">PRAGA</div>
        <button class="btn-main" onclick="goToSetup()">Iniciar</button>
        <button class="btn-main" onclick="toggleOverlay('tutorialOverlay', true)">Tutorial</button>
        <button class="btn-main" onclick="alert('Conquistas: 0/50')">Conquistas</button>
    </div>

    <div id="gameSetup" class="full-screen">
        <div class="glass setup-card" id="step1">
            <h2 style="color: var(--red)">Selecione o Pat√≥geno</h2>
            <div class="type-grid">
                <div class="type-item" onclick="selectType(this, 'Bact√©ria')">ü¶† Bact√©ria</div>
                <div class="type-item" onclick="selectType(this, 'V√≠rus')">üß¨ V√≠rus</div>
                <div class="type-item" onclick="selectType(this, 'Fungo')">üçÑ Fungo</div>
                <div class="type-item" onclick="selectType(this, 'Pr√≠on')">üíé Pr√≠on</div>
            </div>
            <input type="text" id="plagueName" placeholder="Nome da Enfermidade...">
            <button class="btn-main" style="width: 100%" onclick="goToUpgrades()">Pr√≥ximo</button>
        </div>
        
        <div class="glass setup-card" id="step2" style="display: none;">
            <h2 style="color: var(--gold)">Modifica√ß√µes Iniciais</h2>
            <p style="margin: 20px 0; color: #888;">Voc√™ possui <span id="mutPoints">10</span> pontos de mutagenicidade.</p>
            <div class="type-grid">
                <div class="type-item" onclick="buyInitial(this, 5)">Resist√™ncia T√©rmica</div>
                <div class="type-item" onclick="buyInitial(this, 3)">Muta√ß√£o A√©rea</div>
                <div class="type-item" onclick="buyInitial(this, 2)">Sintoma Tosse</div>
            </div>
            <button class="btn-main" style="width: 100%" onclick="finalizeSetup()">Come√ßar Simula√ß√£o</button>
        </div>
    </div>

    <div id="mainGame">
        <div id="map"></div>
        
        <div class="glass top-hud">
            <span style="color: var(--red); font-weight: 800; margin-right: 15px;">NOT√çCIAS</span>
            <marquee id="newsTicker">AGUARDANDO SURTO INICIAL EM UM PA√çS...</marquee>
            <button onclick="toggleOverlay('settingsOverlay', true)" style="background:none; border:none; color:white; font-size:1.5rem; cursor:pointer; margin-left:20px;">‚öôÔ∏è</button>
        </div>

        <div class="glass bottom-hud">
            <button class="btn-main" style="width: 180px; font-size: 0.9rem;" onclick="openOverlay('evolution')">Status da Enfermidade</button>
            
            <div class="bars-box">
                <div class="bar-wrap">
                    <span class="bar-label" id="labelInf">Infectados</span>
                    <div class="bar-bg"><div class="bar-fill" id="barInf" style="background: var(--red);"></div></div>
                </div>
                <div class="bar-wrap">
                    <span class="bar-label" id="labelMort">Mortos</span>
                    <div class="bar-bg"><div class="bar-fill" id="barMort" style="background: #444;"></div></div>
                </div>
                <div class="bar-wrap">
                    <span class="bar-label" id="labelCura">Progresso da Cura</span>
                    <div class="bar-bg"><div class="bar-fill" id="barCura" style="background: var(--blue);"></div></div>
                </div>
                <div class="bar-wrap">
                    <span class="bar-label" id="labelVac">Progresso da Vacina</span>
                    <div class="bar-bg"><div class="bar-fill" id="barVac" style="background: var(--green);"></div></div>
                </div>
            </div>

            <div style="text-align: right; min-width: 100px;">
                <span id="gameMutPoints" style="color: var(--gold); font-size: 1.8rem; font-weight: bold;">10</span>
                <div style="font-size: 0.6rem; color: var(--gold);">MUTAGENICIDADE</div>
            </div>
            <button class="btn-main" style="width: 120px; font-size: 0.9rem; background: var(--blue); color: black;" onclick="openOverlay('world')">Mundo</button>
        </div>
    </div>

    <div id="tutorialOverlay" class="overlay">
        <div class="glass setup-card" style="position: relative; width: 80%; max-width: 600px;">
            <button class="btn-close" onclick="toggleOverlay('tutorialOverlay', false)">‚úï</button>
            <h2 style="margin-bottom: 20px;">Manual de Opera√ß√µes</h2>
            <div style="text-align: left; color: #ccc; line-height: 1.6;">
                <p>‚Ä¢ <b>In√≠cio:</b> Selecione um pa√≠s clicando no mapa para iniciar o cont√°gio.</p>
                <p>‚Ä¢ <b>Muta√ß√£o:</b> Use pontos de Mutagenicidade para evoluir. Muta√ß√µes atrasam a pesquisa humana.</p>
                <p>‚Ä¢ <b>Pesquisa:</b> Conforme o mundo nota sua praga, os esfor√ßos para Cura e Vacina aumentam.</p>
                <p>‚Ä¢ <b>Popula√ß√£o:</b> O total de mortos, infectados e vacinados nunca excede 8 bilh√µes.</p>
            </div>
        </div>
    </div>

    <div id="settingsOverlay" class="overlay">
        <div class="glass setup-card" style="position: relative;">
            <button class="btn-close" onclick="toggleOverlay('settingsOverlay', false)">‚úï</button>
            <h2>Configura√ß√µes</h2>
            <button class="btn-main" style="width: 100%" onclick="alert('Som alterado')">Som: ON/OFF</button>
            <button class="btn-main" style="width: 100%" onclick="alert('Efeitos alterados')">SFX: ON/OFF</button>
            <button class="btn-main" style="width: 100%" onclick="alert('Jogo Pausado')">Pausar</button>
            <button class="btn-main" style="width: 100%; background: #444; color: white;" onclick="location.reload()">Salvar & Sair</button>
        </div>
    </div>

    <div id="countryPopup" class="glass country-popup">
        <button class="btn-close" style="top:5px; right:10px; font-size: 1.2rem;" onclick="this.parentElement.style.display='none'">‚úï</button>
        <h2 id="popCountryName" style="color: var(--blue); margin-bottom: 10px;">BRASIL</h2>
        <div id="popContent" style="color: #ccc; font-size: 1rem;">Carregando dados t√°ticos...</div>
        <hr style="margin: 15px 0; border: 0; border-top: 1px solid #333;">
        <button id="btnStartOutbreak" class="btn-main" style="width:100%; font-size: 1rem; padding: 10px;" onclick="startInfection()">Iniciar Surto aqui</button>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // ESTADO GLOBAL DO JOGO
        let gameState = {
            started: false,
            type: '',
            name: '',
            mutPoints: 10,
            population: 8000000000,
            infected: 0,
            dead: 0,
            cured: 0,
            vaccinated: 0,
            curaProgress: 0,
            vacinaProgress: 0,
            selectedCountry: null
        };

        // NAVEGA√á√ÉO
        function goToSetup() { document.getElementById('startMenu').style.display = 'none'; document.getElementById('gameSetup').style.display = 'flex'; }
        function selectType(el, type) {
            document.querySelectorAll('.type-item').forEach(i => i.classList.remove('selected'));
            el.classList.add('selected');
            gameState.type = type;
        }
        function goToUpgrades() {
            gameState.name = document.getElementById('plagueName').value || 'Praga X';
            if(!gameState.type) return alert('Selecione um tipo de pat√≥geno!');
            document.getElementById('step1').style.display = 'none';
            document.getElementById('step2').style.display = 'block';
        }
        function buyInitial(el, cost) {
            if(gameState.mutPoints >= cost) {
                gameState.mutPoints -= cost;
                el.style.opacity = '0.3'; el.onclick = null;
                document.getElementById('mutPoints').innerText = gameState.mutPoints;
                document.getElementById('gameMutPoints').innerText = gameState.mutPoints;
            }
        }
        function finalizeSetup() {
            document.getElementById('gameSetup').style.display = 'none';
            document.getElementById('mainGame').style.display = 'block';
            initMap();
        }

        // ENGINE DO MAPA
        let map;
        function initMap() {
            if (map) return;
            map = L.map('map', { center: [20, 0], zoom: 2.5, zoomControl: false, attributionControl: false });
            L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);
            
            map.on('click', (e) => {
                // Simula√ß√£o de geocode reverso simples para exemplo
                gameState.selectedCountry = "Regi√£o Geogr√°fica";
                document.getElementById('popCountryName').innerText = "ZONA SELECIONADA";
                document.getElementById('popContent').innerHTML = `Coord: ${e.latlng.lat.toFixed(2)}, ${e.latlng.lng.toFixed(2)}<br>Clima: Vari√°vel<br>Status: Saud√°vel`;
                document.getElementById('countryPopup').style.display = 'block';
            });
        }

        function startInfection() {
            gameState.started = true;
            gameState.infected = 1;
            document.getElementById('countryPopup').style.display = 'none';
            document.getElementById('newsTicker').innerText = `PRIMEIRO CASO DE ${gameState.name.toUpperCase()} CONFIRMADO!`;
            gameLoop();
        }

        // L√ìGICA DE JOGO (LOOP)
        function gameLoop() {
            setInterval(() => {
                if(!gameState.started) return;

                // Crescimento da Infec√ß√£o
                let growth = Math.ceil(gameState.infected * 0.15);
                if(gameState.infected < gameState.population) {
                    gameState.infected += growth;
                }

                // Esfor√ßo de Cura/Vacina (baseado na gravidade do surto)
                if(gameState.infected > 10000) {
                    gameState.curaProgress += 0.1;
                    gameState.vacinaProgress += 0.05;
                }

                updateUI();
            }, 1000);
        }

        function updateUI() {
            // Atualizar Barras
            document.getElementById('barInf').style.width = (gameState.infected / gameState.population * 100) + '%';
            document.getElementById('barCura').style.width = gameState.curaProgress + '%';
            document.getElementById('barVac').style.width = gameState.vacinaProgress + '%';

            // L√≥gica de finaliza√ß√£o de pesquisa
            if(gameState.curaProgress >= 100) {
                document.getElementById('labelCura').innerText = "Curados";
                document.getElementById('labelCura').style.color = "var(--blue)";
            }
            if(gameState.vacinaProgress >= 100) {
                document.getElementById('labelVac').innerText = "Vacinados";
                document.getElementById('labelVac').style.color = "var(--green)";
            }
        }

        function toggleOverlay(id, show) {
            document.getElementById(id).style.display = show ? 'flex' : 'none';
        }

    </script>
</body>
</html>